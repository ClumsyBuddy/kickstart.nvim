
#f45873b3-b655-43a6-b217-97c00aa0db58 powertoys commandnotfound module

import-module -name microsoft.winget.commandnotfound
#f45873b3-b655-43a6-b217-97c00aa0db58



function activate-venv {
    if (test-path ".venv/scripts/activate.ps1") {
        & ".venv/scripts/activate.ps1"
        write-host "virtual environment activated!" -foregroundcolor green
    } elseif (test-path ".venv/scripts/activate.ps1") {
        & ".venv/scripts/activate.ps1"
        write-host "virtual environment activated!" -foregroundcolor green
    } else {
        write-host "no virtual environment found in current directory" -foregroundcolor red
    }
}



function open-rel {
<#
.synopsis
opens a folder in file explorer or visual studio code, resolving relative paths from the current directory.

.description
this function takes a relative path (with or without a trailing slash) and opens it in file explorer by default.
optionally, it can open the folder in visual studio code if the -vscode switch is provided.

.parameter relativepath
the relative path to the folder you want to open.

.parameter vscode
switch to open the folder in visual studio code instead of file explorer.

.example
open-rel 'late fees on deferred payments'
opens the folder in file explorer.

.example
open-rel 'late fees on deferred payments' -vscode
opens the folder in visual studio code.
#>

    param(
        [string]$relativepath,
        [switch]$code
    )

    # remove trailing backslash or slash if present
    $cleanpath = $relativepath.trimend('\', '/')

    # resolve the full path
    $fullpath = resolve-path $cleanpath -erroraction stop

    if ($code) {
        # open the folder in visual studio code
        code $fullpath
    } else {
        # open the folder in file explorer
        explorer $fullpath
    }
}


function rwsl {
    param(
        [parameter(valuefromremainingarguments=$true)]
        [string[]]$args
    )

    $winpath = (get-location).path
    $wslpath = $winpath -replace '^([a-za-z]):', '/mnt/$1' -replace '\\', '/'
    $wslpath = $wslpath.tolower()

    $command = ($args -join ' ')
    $fullcmd = "cd '$wslpath' && $command"

    wsl bash -lc "$fullcmd"
}

function open-currentpathinnewtab {
    # opens a new tab in the current window (-w 0) in the current directory (.)
    wt -w 0 nt -d .
}





invoke-expression (&starship init powershell)
invoke-expression (& { (zoxide init powershell | out-string) })


set-alias -name finds -value findstr
# sets 'nt' as the shortcut for the function above
set-alias -name nt -value open-currentpathinnewtab
